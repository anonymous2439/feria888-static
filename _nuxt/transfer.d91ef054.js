import{a as U,H as V,L as o,U as m,W as g,R as p,V as _,u as t,Q as k,O as A,q as T}from"./swiper-vue.cf378b39.js";import{u as $,b as B}from"./entry.fb7de827.js";import{u as f}from"./fetch.d9e73cbf.js";import{u as C}from"./cookie.c529037a.js";const D=o("h2",{class:"page-title"},"Transfer",-1),L=["onSubmit"],R=o("button",{type:"submit"},"Search",-1),O={class:"user-details"},x=["value"],N=["value"],z=["onSubmit"],K=o("button",null,"Load Coins",-1),W={class:"error-message"},M={__name:"transfer",setup(E){const d=B(),r=C("user_info"),i=$("user_details"),h=U();console.log(r);const c={value:null};let n={id:null,username:null,coins:null,amount:null};async function y(){var s;const{data:e,pending:a,refresh:l}=await f(`${d.public.baseURL}/api/user/search/${c.value}`,{method:"GET",headers:{Authorization:"Bearer "+r.value.token}},"$VpKtR1QDXy");e.value?(i.value=e.value,n.id=e.value.id,n.username=e.value.username,n.email=e.value.email,n.phone_number=e.value.phone_number,n.coins=(s=e==null?void 0:e.value.coins[0])==null?void 0:s.coin_balance):console.log("An error occurred")}async function S(){const e=await w(n.amount);if(e.success>0){const{data:a,pending:l,refresh:s}=await f(`${d.public.baseURL}/api/coins/load`,{method:"POST",body:JSON.stringify({user_id:n.id,amount:n.amount}),headers:{Authorization:"Bearer "+r.value.token}},"$GesZZKWeDh");a.value?(i.value=a.value,window.location.reload(!0)):console.log("An error occurred")}else h.value=e.message}async function w(e){const{data:a,pending:l,refresh:s}=await f(`${d.public.baseURL}/api/wallet/deduct`,{method:"POST",body:JSON.stringify({amount:e}),headers:{Authorization:"Bearer "+r.value.token}},"$sk3yKiVnfh");if(!a)console.log("An error occurred");else return a.value}return(e,a)=>{var l,s,v,b;return T(),V(A,null,[D,o("form",{onSubmit:g(y,["prevent"])},[m(o("input",{"onUpdate:modelValue":a[0]||(a[0]=u=>c.value=u),placeholder:"ID / Username"},null,512),[[_,c.value]]),R],40,L),o("div",O,[o("p",null,[p("ID: "),m(o("input",{"onUpdate:modelValue":a[1]||(a[1]=u=>t(n).id=u),disabled:""},null,512),[[_,t(n).id]])]),o("p",null,[p("Username: "),o("input",{value:((l=t(i))==null?void 0:l.username)||"",disabled:""},null,8,x)]),o("p",null,[p("Coin balance: "),o("input",{value:((b=(v=(s=t(i))==null?void 0:s.coins)==null?void 0:v[0])==null?void 0:b.coin_balance)||0,disabled:""},null,8,N)]),o("form",{onSubmit:g(S,["prevent"])},[m(o("input",{"onUpdate:modelValue":a[2]||(a[2]=u=>t(n).amount=u),placeholder:"Amount"},null,512),[[_,t(n).amount]]),K],40,z),o("p",W,k(t(h)),1)])],64)}}};export{M as default};
